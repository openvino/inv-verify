# INV Data Verifier Contract

## Overview
This repository contains the Solidity smart contract **`InvDataVerifier`**, which is designed to verify hashes generated by the **Instituto Nacional de la Vitivinicultura (INV)** using Zero-Knowledge Proofs (ZKP). The contract provides functionality to securely store and verify data hashes, ensuring the integrity and authenticity of submitted data.

**Note:** This contract is not affiliated with the INV and is provided solely for example and testing purposes as part of the OpenVino initiative.

## Features
- **Data Storage:** Allows authorized users to store a hash of INV-generated data associated with a unique identifier.
- **Data Verification:** Enables verification of submitted data hashes against stored values.
- **Event Emission:** Emits an event when data is successfully stored.
- **Zero-Knowledge Proof Integration:** Built to work with ZKP workflows for secure and private verification processes.

## Purpose
The **InvDataVerifier** contract was developed to:
- Provide a decentralized and tamper-proof mechanism for storing and verifying INV-generated data hashes.
- Support testing and exploration of blockchain-based solutions for the wine industry.
- Facilitate integration with ZKP systems for enhanced privacy.

## Contract Interface

### **Functions**

#### `storeData(string calldata id, bytes32 hash) external`
- **Description:** Stores the hash of the data associated with a unique identifier.
- **Parameters:**
  - `id`: A unique string identifier for the data.
  - `hash`: The hash of the data to be stored.
- **Requirements:**
  - The `id` must not already exist in the mapping.
- **Emits:**
  - `DataStored(id)`

#### `match_inv_data(string calldata id, bytes32 hash) external view returns (bool)`
- **Description:** Verifies if the provided hash matches the stored hash for the given identifier.
- **Parameters:**
  - `id`: A unique string identifier for the data.
  - `hash`: The hash to verify.
- **Returns:**
  - `true` if the provided hash matches the stored hash; otherwise, `false`.
- **Requirements:**
  - The `id` must exist in the mapping.

### **Events**

#### `DataStored(string indexed id)`
- **Description:** Emitted when data is successfully stored in the contract.
- **Parameters:**
  - `id`: The unique identifier associated with the stored data.

## Usage

### Storing Data
```solidity
contract.storeData("wine123", 0xabc123...);
```
- Stores the hash `0xabc123...` associated with the identifier `"wine123"`.

### Verifying Data
```solidity
bool isValid = contract.match_inv_data("wine123", 0xabc123...);
```
- Verifies if the hash `0xabc123...` matches the stored hash for the identifier `"wine123"`.

### Deployment
This contract requires a compatible Ethereum Virtual Machine (EVM) environment. It has been written in Solidity ^0.8.0 to ensure modern features and optimizations.

### Example Deployment Command
Use Remix, Truffle, or Hardhat to deploy the contract:

```bash
npx hardhat run scripts/deploy.js --network <network_name>
```

## Contract Code
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract InvDataVerifier {
   
    mapping(string => bytes32) private dataHashes;

    event DataStored(string indexed id);

    function storeData(string calldata id, bytes32 hash) external {
        require(dataHashes[id] == 0, "ID already exists");
        dataHashes[id] = hash;
        emit DataStored(id);
    }

    function match_inv_data(string calldata id, bytes32 hash) external view returns (bool) {
        bytes32 storedHash = dataHashes[id];
        require(storedHash != 0, "ID does not exist");
        return storedHash == hash;
    }
}
```

## Testing
Unit tests can be implemented using a framework such as Hardhat or Truffle.

### Example Test (Hardhat)
```javascript
const { expect } = require("chai");

let InvDataVerifier;
let invDataVerifier;

beforeEach(async function () {
  InvDataVerifier = await ethers.getContractFactory("InvDataVerifier");
  invDataVerifier = await InvDataVerifier.deploy();
  await invDataVerifier.deployed();
});

describe("InvDataVerifier", function () {
  it("should store and verify data hashes", async function () {
    await invDataVerifier.storeData("wine123", ethers.utils.id("sample_hash"));
    const isValid = await invDataVerifier.match_inv_data("wine123", ethers.utils.id("sample_hash"));
    expect(isValid).to.be.true;
  });
});
```

## Disclaimer
This project is a testing and demonstration tool and is not intended for production use. It is not affiliated with or endorsed by the **Instituto Nacional de la Vitivinicultura (INV)**.

## Contributions
Contributions are welcome! Please fork the repository, create a feature branch, and submit a pull request.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Contact
For inquiries, please contact the OpenVino team at [contact@openvino.org](mailto:contact@openvino.org).

